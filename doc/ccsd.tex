\hypertarget{chap:ccsd}{}
\chapter{Closed shell coupled cluster with singles and doubles}
\label{sec:ccsd}
\chaptermark{CCSD}
\chapterauthor{}

{History:
  
  \begin{tabular}{l@{ - }l}
     2020 & Start\\
  \end{tabular}
}\vspace{3cm}


\section{Notation}

\begin{center}
  \begin{tabular}{ll}
    \hline
    \Hamilt    & The electronic Hamiltonian \\
    $g_{pqrs}$ & Two electron integrals over spatial orbitals \\
               & $= \int dr_1 dr_2 \frac{\phi^*_p(r_1)\phi^*_r(r_2)\phi_q(r_1)\phi_s(r_2)}{r_{12}}$\\
    $L_{pqrs}$ & $= 2g_{pqrs} - g_{psrq}$\\
               & (as suggested in \cite{})\\
    \hline
  \end{tabular}
\end{center}

\newpage
\section{Introduction}

The general equations of coupled cluster theory are ``deceptively simple'',
as R. Bartlet has stated \cite{}:
\begin{equation}
  E = \mel{\Phi_0}{e^{-T}\Hamilt e^T}{\Phi_0}
\end{equation}
\begin{equation}\label{eq:gen_ccsd_ampl_eq}
  0 = \mel{\Phi_\mu}{e^{-T}\Hamilt e^T}{\Phi_0}\,\\\
\end{equation}
where $\Phi_0$ is the reference Slater determinant,
$\Hamilt$ is the electronic Hamiltonian,
and
\begin{equation}
  T = \sum_\mu t_\mu \tau_\mu
\end{equation}
is the cluster operator, with amplitudes $t_\mu$ associated to the excitations $\tau_\mu$.
The amplitudes are obtained after solving equations \eqref{eq:gen_ccsd_ampl_eq},
where $\ket{\Phi_\mu} = \tau_\mu \ket{\Phi_0}$ is the Slater determinant
obtained after acting the excitation $\tau_\mu$ on top of $\ket{\Phi_0}$.

These equations can be made specific to a particular case,
and put in terms of the molecular integrals.
This is done in Section 13.7 of reference \cite{}, that we followed closely in the present
implementation.
Below we show the main equations.
Some of them are directly obtained from \cite{},
whereas in other cases we have adapted them to a form that is more directly related to our implementation.
In section \ref{sec:ccsd_flowchart} we have a flowchart that show,
as precisely as we could make,
the connection between the equations and the code.


\section{Equations}

\subsection{Energy}
\hypertarget{sec:ccsd_energy}{}
\label{sec:ccsd_energy}

\begin{equation}
  \begin{split}
    E =& \mel{\Phi_0}{e^{-T}\Hamilt e^T}{\Phi_0}\\
    =& \mel{\Phi_0}{\Hamilt e^T}{\Phi_0}\\
    =& E_{HF} + \sum_{aibj}(t_{ij}^{ab} + t_i^at_j^b) L_{iajb}
  \end{split}
\end{equation}


\subsection{Residuals}
\hypertarget{sec:ccsd_res}{}
\label{sec:ccsd_res}

\subsubsection{Singles}
\hypertarget{sec:ccsd_res_sing}{}
\label{sec:ccsd_res_sing}

\begin{equation}
  \begin{split}
%    \Omega_i^a &=\sum_{cd}\sum_k(2t_{ki}^{cd}{\tilde g}_{adkc}-t_{ik}^{cd}{\tilde g}_{adkc})\\
%    &-\sum_c\sum_{kl}(2t_{kl}^{ac}{\tilde g}_{kilc}-t_{lk}^{ac}{\tilde g}_{kilc})\\
%    &+\sum_c\sum_k(2t_{ik}^{ac}-t_{ki}^{ac})({\tilde h}_{kc}+\sum_l2{\tilde g}_{kcll}-{\tilde g}_{kllc})\\
%    &+{\tilde h}_{ai}+\sum_k2{\tilde g}_{aikk}-{\tilde g}_{akki}\\
    \Omega_i^a&={\tilde h}_{ai}+\sum_k\{2{\tilde g}_{aikk}-{\tilde g}_{akki}\\
    &+\sum_c[(2t_{ik}^{ac}-t_{ki}^{ac}){\tilde h}_{kc}+\sum_d(2t_{ki}^{cd}-t_{ik}^{cd}){\tilde g}_{adkc}\\
    &-\sum_l(2t_{kl}^{ac}-t_{lk}^{ac}){\tilde g}_{kilc}+(2t_{ik}^{ac}-t_{ki}^{ac})(2{\tilde g}_{kcll}-{\tilde g}_{kllc})]\}\\
    &={\tilde h}_{ai}+\sum_{k}\{{\tilde L}_{aikk}+\sum_c[u_{ik}^{ac}{\tilde h}_{kc}+\sum_d(u_{ki}^{cd}{\tilde g}_{adkc})\\
      &-\sum_l(u_{kl}^{ac}{\tilde g}_{kilc}+u_{ik}^{ac}{\tilde L}_{kcll})]\}
   \end{split}
\end{equation}

\subsubsection{Doubles}
\hypertarget{sec:ccsd_res_doub}{}
\label{sec:ccsd_res_doub}

\begin{equation}
  \begin{split}
    \Omega_{ij}^{ab}&={\tilde g}_{aibj}\\
    &+\sum_{c}[t_{ij}^{ac}({\tilde h}_{bc}+\sum_{k}2{\tilde g}_{bckk}-{\tilde g}_{bkkc})+t_{ji}^{bc}({\tilde h}_{ac}+\sum_{k}2{\tilde g}_{ackk}-{\tilde g}_{akkc})+\sum_dt_{ij}^{cd}{\tilde g}_{acbd}]\\
    &+\sum_{k}[t_{ik}^{ab}({\tilde h}_{kj}+\sum_{l}2{\tilde g}_{kjll}-{\tilde g}_{kllj})+t_{jk}^{ba}({\tilde h}_{ki}+\sum_{l}2{\tilde g}_{kill}-{\tilde g}_{klli})+\sum_lt_{kl}^{ab}{\tilde g}_{kilj}]\\
    &+\sum_{c}\sum_{k}\{-2^{-1}t_{kj}^{bc}{\tilde g}_{kiac}-t_{ki}^{bc}{\tilde g}_{kjac}-2^{-1}t_{ki}^{ac}{\tilde g}_{kjbc}-t_{kj}^{ac}{\tilde g}_{kibc}\\
    &+(t_{jk}^{bc}-2^{-1}t_{kj}^{bc})(2{\tilde g}_{aikc}-{\tilde g}_{acki})+(t_{ik}^{ac}-2^{-1}t_{ki}^{ac})(2{\tilde g}_{bjkc}-{\tilde g}_{bckj})\\
    &+\sum_{d}\sum_{l}[t_{kl}^{ab}t_{ij}^{cd}+t_{kj}^{bd}t_{li}^{ac}+2^{-1}t_{ki}^{bd}t_{lj}^{ac}+t_{ki}^{ad}t_{lj}^{bc}+2^{-1}t_{kj}^{ad}t_{li}^{bc}\\
    &+2t_{jl}^{bd}t_{ik}^{ac}-t_{jl}^{bc}t_{ik}^{ad}-t_{jl}^{bd}t_{ki}^{ac}-t_{lj}^{bd}t_{ik}^{ac}+2^{-1}t_{jl}^{bc}t_{ki}^{ad}+2^{-1}t_{lj}^{bc}t_{ik}^{ad}+2^{-1}t_{lj}^{bd}t_{ki}^{ac}-4^{-1}t_{lj}^{bc}t_{ki}^{ad}\\
    &+2t_{il}^{ad}t_{jk}^{bc}-t_{il}^{ac}t_{jk}^{bd}-t_{il}^{ad}t_{kj}^{bc}-t_{li}^{ad}t_{jk}^{bc}+2^{-1}t_{il}^{ac}t_{kj}^{bd}+2^{-1}t_{li}^{ac}t_{jk}^{bd}+2^{-1}t_{li}^{ad}t_{kj}^{bc}-4^{-1}t_{li}^{ac}t_{kj}^{bd}\\
    &-t_{ij}^{ad}(2t_{lk}^{bc}-t_{kl}^{bc})-t_{ik}^{ab}(2t_{lj}^{dc}-t_{jl}^{dc}))-t_{ji}^{bd}(2t_{lk}^{ac}-t_{kl}^{ac})-t_{jk}^{ba}(2t_{li}^{dc}-t_{il}^{dc})]{\tilde g}_{kcld}\}
  \end{split}
\end{equation}


\subsection{Amplitudes update}
\hypertarget{sec:ccsd_update}{}
\label{sec:ccsd_update}

\begin{equation}
  t_\mu = t_\mu + \Delta t_\mu
\end{equation}

\begin{equation}
  \Delta t_i^a = \frac{\Omega_i^a(\mathbf{t})}{\epsilon_a - \epsilon_i}
\end{equation}

\begin{equation}
  \Delta t_{ij}^{ab} = \frac{\Omega_{ij}^{ab}(\mathbf{t})}
  {\epsilon_a + \epsilon_b - \epsilon_i - \epsilon_j}
\end{equation}



\newpage
\section{Flowchart of the algorithm}
\label{sec:ccsd_flowchart}

\input{ccsd_flowchart}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "grassmann_doc.tex"
%%% End:
