"""Tests for IntermNormWaveFunction

"""
import unittest

import numpy as np

from wave_functions import fci
from wave_functions.interm_norm import IntermNormWaveFunction
import tests


class FromFCITestCase(unittest.TestCase):

    def test_1(self):
        pass



class FromMolproTestCase(unittest.TestCase):

    def setUp(self):
        self.addTypeEqualityFunc(np.ndarray, tests.assert_arrays)

    def test_h2_sto3g_d2h(self):
        wf = IntermNormWaveFunction.from_Molpro(
            tests.CCSD_file('H2__5__sto3g__D2h'))
        self.assertEqual(wf.amplitudes, np.array([-0.86355553]))
        self.assertEqual(wf.n_irrep, 8)
        self.assertTrue(wf.restricted)

    def test_h2_631g_c2v(self):
        wf = IntermNormWaveFunction.from_Molpro(
            tests.CCSD_file('H2__5__631g__C2v'))
        self.assertEqual(wf.amplitudes, np.array(
            # Singles:
            [#               i, a       irrep = 0
             -0.00000000,  # 0, 0
              0.07852602,  # 0, 1
             -0.00000000,  # 0, 2
             # ==============================================
             # Doubles:
             # ---> pair ij = 0: (i, i_irrep) = (0, 0)   j, j_irrep = (0, 0)
             #               a, b     irrep_a = 0
             -0.78356502,  # 0, 0
              0.00000000,  # 0, 1
             -0.07011574,  # 0, 2
              0.00000000,  # 1, 0
             -0.00272632,  # 1, 1
             -0.00000000,  # 1, 2
             -0.07011574,  # 2, 0
             -0.00000000,  # 2, 1
             -0.00808512,  # 2, 2
            ]))
        self.assertEqual(wf.n_irrep, 4)
        self.assertTrue(wf.restricted)

    def test_h2_ccpvdz_c2v(self):
        wf = IntermNormWaveFunction.from_Molpro(
            tests.CCSD_file('H2__5__ccpVDZ__C2v'))
        my_ampl = np.array(
            # Singles:
            [#               i, a    irrep = 0
              0.00000000,  # 0, 0
             -0.10780149,  # 0, 1
              0.00000000,  # 0, 2
             -0.00566969,  # 0, 3
              0.00000000,  # 0, 4
              # ==============================================
              # Doubles:
              # ---> pair ij = 0: (i, i_irrep) = (0, 0)   j, j_irrep = (0, 0)
              #              a, b     irrep_a = 0
             -0.76921165,  # 0, 0
             -0.00000000,  # 0, 1
              0.10150132,  # 0, 2
              0.00000000,  # 0, 3
             -0.00563809,  # 0, 4
             -0.00000000,  # 1, 0
             -0.00322314,  # 1, 1
             -0.00000000,  # 1, 2
              0.00021971,  # 1, 3
             -0.00000000,  # 1, 4
              0.10150132,  # 1, 0
             -0.00000000,  # 2, 1
             -0.01518971,  # 2, 2
             -0.00000000,  # 2, 3
              0.00068753,  # 2, 4
              0.00000000,  # 3, 0
              0.00021971,  # 3, 1
             -0.00000000,  # 3, 2
             -0.00549708,  # 3, 3
              0.00000000,  # 3, 4
             -0.00563809,  # 4, 0
             -0.00000000,  # 4, 1
              0.00068753,  # 4, 2
              0.00000000,  # 4, 3
             -0.00120278,  # 4, 4
              #              a, b     irrep_a = 1
             -0.00374441,  # 0, 0
              0.00000000,  # 0, 1
              0.00000000,  # 1, 0
             -0.00148179,  # 1, 1
              #              a, b     irrep_a = 2
             -0.00374441,  # 0, 0
              0.00000000,  # 0, 1
              0.00000000,  # 1, 0
             -0.00148179,  # 1, 1
            ])
        self.assertEqual(wf.amplitudes, my_ampl)
        self.assertEqual(wf.n_irrep, 4)
        self.assertTrue(wf.restricted)

    def test_hcl_631g_c2v(self):
        wf = IntermNormWaveFunction.from_Molpro(
            tests.CCSD_file('HCl__1.5__631g__C2v'))
        my_ampl = np.array(
            # Singles:
            [# ----------    i, a    irrep = 0
             -0.00014166,  # 0, 0
             -0.00315634,  # 0, 1
              0.00174224,  # 0, 2
             -0.00075553,  # 0, 3
             -0.00087725,  # 1, 0
              0.00203402,  # 1, 1
              0.00606624,  # 1, 2
             -0.00102091,  # 1, 3
             # ----------    i, a    irrep = 1
              0.00731866,  # 0, 0
             # ----------    i, a    irrep = 2
              0.00731866,  # 0, 0
             # ==============================================
             # Doubles:
             # ====> pair ij = 0:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 0)
             # ----------    a, b    irrep_a = 0  (=> irrep_b = 0)
             -0.00792707,  # 0, 0
              0.00309373,  # 0, 1
             -0.00187224,  # 0, 2
             -0.01071886,  # 0, 3
              0.00309373,  # 1, 0
             -0.01368087,  # 1, 1
              0.00048542,  # 1, 2
             -0.00421862,  # 1, 3
             -0.00187224,  # 2, 0
              0.00048542,  # 2, 1
             -0.00387597,  # 2, 2
             -0.00277093,  # 2, 3
             -0.01071886,  # 3, 0
             -0.00421862,  # 3, 1
             -0.00277093,  # 3, 2
             -0.02225884,  # 3, 3
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
             -0.00674917,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
             -0.00674917,  # 0, 0
             # ====> pair ij = 1:   (i = 0, i_irrep = 0); (j = 1, j_irrep = 0)
             # ----------    a, b    irrep_a = 0  (=> irrep_b = 0)
              0.00486590,  # 0, 0
             -0.00146212,  # 0, 1
             -0.00476326,  # 0, 2
              0.00669938,  # 0, 3
              0.00079211,  # 1, 0
              0.00963770,  # 1, 1
              0.00710552,  # 1, 2
              0.00844545,  # 1, 3
              0.00078957,  # 2, 0
              0.00209965,  # 2, 1
             -0.01024934,  # 2, 2
              0.00450950,  # 2, 3
              0.00697936,  # 3, 0
              0.00516810,  # 3, 1
             -0.00118494,  # 3, 2
              0.01544026,  # 3, 3
             # ----------    a, b    irrep_a = 1  (=> irrep_b = 1)
             -0.00407663,  # 0, 0
             # ----------    a, b    irrep_a = 2  (=> irrep_b = 2)
             -0.00407663,  # 0, 0
             # ====> pair ij = 2:  (i = 1, i_irrep 0); (j = 1, j_irrep = 0)
             # ----------    a, b    irrep_a = 0
             -0.02275450,  # 0, 0
             -0.00720109,  # 0, 1
              0.00303153,  # 0, 2
             -0.01575975,  # 0, 3
             -0.00720109,  # 1, 0
             -0.00989622,  # 1, 1
             -0.00111353,  # 1, 2
             -0.01084226,  # 1, 3
              0.00303153,  # 2, 0
             -0.00111353,  # 2, 1
             -0.03064355,  # 2, 2
              0.00877140,  # 2, 3
             -0.01575975,  # 3, 0
             -0.01084226,  # 3, 1
              0.00877140,  # 3, 2
             -0.02266788,  # 3, 3
             # ----------    a, b     irrep_a = 1
             -0.00550082,  # 0, 0
             # ----------    a, b     irrep_a = 2
             -0.00550082,  # 0, 0
             # ====> pair ij = 3:  (i = 0, i_irrep = 0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0
             -0.00985632,  # 0, 0
              0.01210219,  # 1, 0
             -0.00917792,  # 2, 0
             -0.00813465,  # 3, 0
             # ----------    a, b     irrep_a = 1
             -0.00652416,  # 0, 0
              0.00208640,  # 0, 1
             -0.00496870,  # 0, 2
             -0.00674374,  # 0, 3
             # ====> pair ij = 4:  (i = 1, i_irrep =  0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (irrep_b = 1)
              0.00036483,  # 0, 0
             -0.00344245,  # 1, 0
             -0.02430901,  # 2, 0
              0.00272304,  # 3, 0
             # ----------    a, b     irrep_a = 1  (irrep_b = 0)
             -0.00211533,  # 0, 0
              0.00104057,  # 0, 1
             -0.00917737,  # 0, 2
             -0.00049167,  # 0, 3
             # ====> pair ij = 5:  (i = 0, i_irrep = 1); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (irrep_b = 0)
             -0.00911375,  # 0, 0
             -0.00396353,  # 0, 1
             -0.00069415,  # 0, 2
             -0.00610306,  # 0, 3
             -0.00396353,  # 1, 0
             -0.01256441,  # 1, 1
              0.00717613,  # 1, 2
             -0.00086672,  # 1, 3
             -0.00069415,  # 2, 0
              0.00717613,  # 2, 1
             -0.01074585,  # 2, 2
             -0.00125227,  # 2, 3
             -0.00610306,  # 3, 0
             -0.00086672,  # 3, 1
             -0.00125227,  # 3, 2
             -0.00575189,  # 3, 3
             # ----------    a, b     irrep_a = 1  (irrep_b = 1)
             -0.04065767,  # 0, 0
             # ----------    a, b     irrep_a = 2  (irrep_b = 2)
             -0.00384435,  # 0, 0
             # ====> pair ij = 6:  (i = 0, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 2)
             -0.00985632,  # 0, 0
              0.01210219,  # 1, 0
             -0.00917792,  # 2, 0
             -0.00813465,  # 3, 0
             # ----------    a, b     irrep_a = 2  (irrep_b = 0)
             -0.00652416,  # 0, 0
              0.00208640,  # 0, 1
             -0.00496870,  # 0, 2
             -0.00674374,  # 0, 3
             # ====> pair ij = 7: (i = 1, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (irrep_b = 2)
              0.00036483,  # 0, 0
             -0.00344245,  # 1, 0
             -0.02430901,  # 2, 0
              0.00272304,  # 3, 0
             # ----------    a, b     irrep_a = 2  (irrep_b = 0)
             -0.00211533,  # 0, 0
              0.00104057,  # 0, 1
             -0.00917737,  # 0, 2
             -0.00049167,  # 0, 3
             # ====> pair ij = 8: (i = 0, i_irrep = 1);  (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 2)
             -0.02889921,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 0)
             -0.00791411,  # 0, 0
             # ====> pair ij = 9: (i = 0, i_irrep = 2); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 0)
             -0.00911375,  # 0, 0
             -0.00396353,  # 0, 1
             -0.00069415,  # 0, 2
             -0.00610306,  # 0, 3
             -0.00396353,  # 1, 0
             -0.01256441,  # 1, 1
              0.00717613,  # 1, 2
             -0.00086672,  # 1, 3
             -0.00069415,  # 2, 0
              0.00717613,  # 2, 1
             -0.01074585,  # 2, 2
             -0.00125227,  # 2, 3
             -0.00610306,  # 3, 0
             -0.00086672,  # 3, 1
             -0.00125227,  # 3, 2
             -0.00575189,  # 3, 3
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
             -0.00384435,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
             -0.04065767   # 0, 0
            ])
        self.assertEqual(wf.amplitudes, my_ampl)
    
    def test_hcl_631g_c2v(self):
        wf = IntermNormWaveFunction.from_Molpro(
            tests.CCSD_file('HCl_plus__1.5__631g__C2v'))
        my_ampl = np.array(
            # Singles:
            [# alpha -> alpha
             # ----------    i, a    irrep = 0
              0.01784805,  # 0, 0
              0.00830479,  # 0, 1
             -0.00803180,  # 0, 2
              0.01852627,  # 0, 3
             -0.00135112,  # 1, 0
              0.00081741,  # 1, 1
              0.00294875,  # 1, 2
             -0.00439943,  # 1, 3
             # ----------    i, a    irrep = 1
             -0.00232514,  # 0, 0
             # ----------    i, a    irrep = 2
             -0.00232514,  # 0, 0
             # beta -> beta
             # ----------    i, a    irrep = 0
              0.00958290,  # 0, 0
             -0.01382469,  # 0, 1
             -0.01094433,  # 0, 2
              0.00815319,  # 0, 3
             -0.01471423,  # 0, 5
             # ----------    i, a    irrep = 1
              0.01706957,  # 0, 0
             # ----------    i, a    irrep = 2
              0.01706957,  # 0, 0
             # ==============================================
             # Doubles:
             # alpha,alpha -> alpha,alpha
             # ====> pair ij = 0:   (i = 0, i_irrep = 0); (j = 1, j_irrep = 0)
             # ----------    a, b    irrep_a = 0  (=> irrep_b = 0)
              0.00000000,  # 0, 0
             -0.00185862,  # 0, 1
             -0.00410708,  # 0, 2
              0.00093532,  # 0, 3
              0.00185862,  # 1, 0
             -0.00000000,  # 1, 1
              0.00458857,  # 1, 2
              0.00204848,  # 1, 3
              0.00410708,  # 2, 0
             -0.00458857,  # 2, 1
             -0.00000000,  # 2, 2
              0.00470146,  # 2, 3
             -0.00093532,  # 3, 0
             -0.00204848,  # 3, 1
             -0.00470146,  # 3, 2
             -0.00000000,  # 3, 3
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
              0.00000000,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
              0.00000000,  # 0, 0
             # ====> pair ij = 1:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
             -0.00245781,  # 0, 0
              0.00851271,  # 0, 1
             -0.00317859,  # 0, 2
             -0.00160909,  # 0, 3
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
              0.00245781,  # 0, 0
             -0.00851271,  # 1, 0
              0.00317859,  # 2, 0
              0.00160909,  # 3, 0
             # ====> pair ij = 2:   (i = 1, i_irrep = 0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
              0.00032344,  # 0, 0
             -0.00319323,  # 0, 1
             -0.01318522,  # 0, 2
              0.00312449,  # 0, 3
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
             -0.00032344,  # 0, 0
              0.00319323,  # 1, 0
              0.01318522,  # 2, 0
             -0.00312449,  # 3, 0
             # ====> pair ij = 3:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 2)
             -0.00245781,  # 0, 0
              0.00851271,  # 0, 1
             -0.00317859,  # 0, 2
             -0.00160909,  # 0, 3
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 0)
              0.00245781,  # 0, 0
             -0.00851271,  # 1, 0
              0.00317859,  # 2, 0
              0.00160909,  # 3, 0
             # ====> pair ij = 4:   (i = 1, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 2)
              0.00032344,  # 0, 0
             -0.00319323,  # 0, 1
             -0.01318522,  # 0, 2
              0.00312449,  # 0, 3
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 0)
             -0.00032344,  # 0, 0
              0.00319323,  # 1, 0
              0.01318522,  # 2, 0
             -0.00312449,  # 3, 0
             # ====> pair ij = 5:   (i = 0, i_irrep = 1); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 2)
             -0.01787448,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 1)
              0.01787448,  # 0, 0
             # beta,beta -> beta,beta
             # ====> pair ij = 6:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
             -0.00599544,  # 0, 0
             -0.00182103,  # 0, 1
              0.00931941,  # 0, 2
             -0.00340175,  # 0, 3
             -0.00186764,  # 0, 4
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
              0.00599544,  # 0, 0
              0.00182103,  # 1, 0
             -0.00931941,  # 2, 0
              0.00340175,  # 3, 0
              0.00186764,  # 4, 0
             # ====> pair ij = 7:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
             -0.00599544,  # 0, 0
             -0.00182103,  # 0, 1
              0.00931941,  # 0, 2
             -0.00340175,  # 0, 3
             -0.00186764,  # 0, 4
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
              0.00599544,  # 0, 0
              0.00182103,  # 1, 0
             -0.00931941,  # 2, 0
              0.00340175,  # 3, 0
              0.00186764,  # 4, 0
             # ====> pair ij = 8:   (i = 0, i_irrep = 1); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 2)
             -0.01888335,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 1)
              0.01888335,  # 0, 0
             # alpha,beta -> alpha,beta
             # ====> pair ij = 9:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 0)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 0)
              0.01040549,  # 0, 0
             -0.01082775,  # 0, 1
              0.00074585,  # 0, 2
              0.00008689,  # 0, 3
             -0.01434188,  # 0, 4
              0.01264477,  # 1, 0
             -0.00006409,  # 1, 1
             -0.01304051,  # 1, 2
              0.00108684,  # 1, 3
             -0.00361534,  # 1, 4
              0.00570174,  # 2, 0
             -0.00014829,  # 2, 1
              0.00077905,  # 2, 2
             -0.00290351,  # 2, 3
             -0.00000741,  # 2, 4
              0.01885835,  # 3, 0
             -0.01398380,  # 3, 1
             -0.00329637,  # 3, 2
              0.00022332,  # 3, 3
             -0.02257707,  # 3, 4
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
             -0.00504730,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
             -0.00504730,  # 0, 0
             # ====> pair ij = 10:   (i = 1, i_irrep = 0); (j = 0, j_irrep = 0)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 0)
             -0.03124254,  # 0, 0
              0.00506846,  # 0, 1
              0.00269563,  # 0, 2
             -0.00023777,  # 0, 3
              0.00696701,  # 0, 4
             -0.01906441,  # 1, 0
              0.00083530,  # 1, 1
              0.00754846,  # 1, 2
              0.00155938,  # 1, 3
              0.00371387,  # 1, 4
              0.01609830,  # 2, 0
             -0.00438010,  # 2, 1
              0.00611681,  # 2, 2
             -0.00725038,  # 2, 3
             -0.00324607,  # 2, 4
             -0.03305315,  # 3, 0
              0.00788073,  # 3, 1
              0.00571272,  # 3, 2
              0.00142515,  # 3, 3
              0.01270294,  # 3, 4
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
             -0.00320008,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
             -0.00320008,  # 0, 0
             # ====> pair ij = 11:   (i = 0, i_irrep = 1); (j = 0, j_irrep = 0)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
             -0.00620254,  # 0, 0
              0.00243941,  # 1, 0
             -0.00315527,  # 2, 0
             -0.00662562,  # 3, 0
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
              0.00492964,  # 0, 0
             -0.00763695,  # 0, 1
              0.01161329,  # 0, 2
             -0.00650954,  # 0, 3
             -0.00802549,  # 0, 4
             # ====> pair ij = 12:   (i = 0, i_irrep = 2); (j = 0, j_irrep = 0)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 2)
             -0.00620254,  # 0, 0
              0.00243941,  # 1, 0
             -0.00315527,  # 2, 0
             -0.00662562,  # 3, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 0)
              0.00492964,  # 0, 0
             -0.00763695,  # 0, 1
              0.01161329,  # 0, 2
             -0.00650954,  # 0, 3
             -0.00802549,  # 0, 4
             # ====> pair ij = 13:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
             -0.00877416,  # 0, 0
              0.01069290,  # 1, 0
             -0.00615560,  # 2, 0
             -0.00820397,  # 3, 0
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
              0.01078515,  # 0, 0
             -0.00523606,  # 0, 1
              0.00246647,  # 0, 2
             -0.00327658,  # 0, 3
             -0.00540235,  # 0, 4
             # ====> pair ij = 14:   (i = 1, i_irrep = 0); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 1)
             -0.00129085,  # 0, 0
             -0.00207164,  # 1, 0
             -0.01993592,  # 2, 0
              0.00292524,  # 3, 0
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 0)
              0.01899016,  # 0, 0
             -0.00166252,  # 0, 1
              0.00111767,  # 0, 2
             -0.00675456,  # 0, 3
             -0.00026334,  # 0, 4
             # ====> pair ij = 15:   (i = 0, i_irrep = 1); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 0)
              0.02353907,  # 0, 0
             -0.01067318,  # 0, 1
             -0.00341709,  # 0, 2
              0.00008884,  # 0, 3
             -0.00626447,  # 0, 4
              0.00803844,  # 1, 0
             -0.00349113,  # 1, 1
             -0.00894336,  # 1, 2
              0.00569302,  # 1, 3
              0.00022746,  # 1, 4
              0.00427690,  # 2, 0
              0.00014090,  # 2, 1
              0.00604549,  # 2, 2
             -0.00874597,  # 2, 3
             -0.00073746,  # 2, 4
              0.00426871,  # 3, 0
             -0.00636713,  # 3, 1
              0.00026795,  # 3, 2
             -0.00036740,  # 3, 3
             -0.00563170,  # 3, 4
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
             -0.03355893,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
             -0.00322050,  # 0, 0
             # ====> pair ij = 16:   (i = 0, i_irrep = 2); (j = 0, j_irrep = 1)
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 2)
             -0.00608946,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 1)
             -0.02424898,  # 0, 0
             # ====> pair ij = 17:   (i = 0, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 2)
             -0.00877416,  # 0, 0
              0.01069290,  # 1, 0
             -0.00615560,  # 2, 0
             -0.00820397,  # 3, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 0)
              0.01078515,  # 0, 0
             -0.00523606,  # 0, 1
              0.00246647,  # 0, 2
             -0.00327658,  # 0, 3
             -0.00540235,  # 0, 4
             # ====> pair ij = 18:   (i = 1, i_irrep = 0); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 2)
             -0.00129085,  # 0, 0
             -0.00207164,  # 1, 0
             -0.01993592,  # 2, 0
              0.00292524,  # 3, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 0)
              0.01899016,  # 0, 0
             -0.00166252,  # 0, 1
              0.00111767,  # 0, 2
             -0.00675456,  # 0, 3
             -0.00026334,  # 0, 4
             # ====> pair ij = 19:   (i = 0, i_irrep = 1); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 2)
             -0.02424898,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 1)
             -0.00608946,  # 0, 0
             # ====> pair ij = 20:   (i = 0, i_irrep = 2); (j = 0, j_irrep = 2)
             # ----------    a, b     irrep_a = 0  (=> irrep_b = 0)
              0.02353907,  # 0, 0
             -0.01067318,  # 0, 1
             -0.00341709,  # 0, 2
              0.00008884,  # 0, 3
             -0.00626447,  # 0, 4
              0.00803844,  # 1, 0
             -0.00349113,  # 1, 1
             -0.00894336,  # 1, 2
              0.00569302,  # 1, 3
              0.00022746,  # 1, 4
              0.00427690,  # 2, 0
              0.00014090,  # 2, 1
              0.00604549,  # 2, 2
             -0.00874597,  # 2, 3
             -0.00073746,  # 2, 4
              0.00426871,  # 3, 0
             -0.00636713,  # 3, 1
              0.00026795,  # 3, 2
             -0.00036740,  # 3, 3
             -0.00563170,  # 3, 4
             # ----------    a, b     irrep_a = 1  (=> irrep_b = 1)
             -0.00322050,  # 0, 0
             # ----------    a, b     irrep_a = 2  (=> irrep_b = 2)
             -0.03355893   # 0, 0
            ])
        self.assertEqual(wf.amplitudes, my_ampl)
